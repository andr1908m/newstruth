<!DOCTYPE html>
<html>
<head>
  <title>NewsTruth</title>
  
 
  <link href='https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css' rel='stylesheet' type='text/css'>
  
  <script src="https://use.fontawesome.com/c5f7817904.js"></script>
  <script src="https://code.jquery.com/jquery-3.2.1.js"></script>



   
   

  <script type="text/javascript">

// window.fbAsyncInit.apply();



var topic = 'apple';

var currentDate = new Date();

console.log(currentDate.toLocaleDateString());


var url = 'https://newsapi.org/v2/everything?' +
          'q=' + topic + '&' +
          'from=' + currentDate + "&" +
          'apiKey=ecd3e07151554b989cf0b15d8fd91c6c';

var req = new Request(url);
fetch(req)
    .then(response => response.json())
    .then(json => {
        console.log(json);
        if (json.hasOwnProperty('articles')) {
            var articles = json['articles']
            
            
            //var currentElement = 0;
            for (key in articles) {
                
                if (key < 5){
                var record = articles[key];
                console.log(record);
                

                if (record.hasOwnProperty('title') && record.hasOwnProperty('url') && record.hasOwnProperty('publishedAt')) {
                    
                    var url;
                    console.log(record.title);
                    // lol
                    if (record.url.search("www.") == -1){
                    	var firstPart = record.url.substring(0, record.url.indexOf("//") +2);
                    	var secondPart = record.url.substring(record.url.indexOf("//") +3);
                    	var newString = firstPart + "www." + secondPart;
                    	console.log(newString);
                    	url = newString;
                    }


                    $(document).ready(function(){
                    $("#headline" + 1).attr("href", url);
                    $("#headline" + 1).text(articles[0].title);
	 				});	

                    $(document).ready(function(){
                    $("#headline" + 2).attr("href", url);
                    $("#headline" + 2).text(articles[1].title);
	 				});

	 				$(document).ready(function(){
                    $("#headline" + 3).attr("href", url);
                    $("#headline" + 3).text(articles[2].title);
	 				});
	 				$(document).ready(function(){
                    $("#headline" + 4).attr("href", url);
                    $("#headline" + 4).text(articles[3].title);
	 				});

	 				$(document).ready(function(){
	 				$("#headline" + 5).attr("href", url);
                    $("#headline" + 5).text(articles[4].title);
	 				});

	 				console.log(record.publishedAt);
                    console.log("");
                    //currentElement++;

                    }

                }
              
             }

             }
        
    })



  	
  </script>




</head>

 <body class="container-fluid">
<!-- facebook script -->
<script>

    
  // This is called with the results from from FB.getLoginStatus().
  function statusChangeCallback(response) {
    // The response object is returned with a status field that lets the
    // app know the current login status of the person.
    // Full docs on the response object can be found in the documentation
    // for FB.getLoginStatus().
    if (response.status === 'connected') {
      // Logged into your app and Facebook.
//       FB.login( function(response) {
//       var user_access_token = "";
        
//         //me?fields=about,address,education,birthday,age_range,currency,gender,first_name,hometown
//         //fields=education,age_range,gender,first_name,hometown,work,is_verified
        
//         $.getJSON('https://graph.facebook.com/me?fields=education,age_range,gender,first_name,hometown,work,is_verified&access_token='+user_access_token, function(mydata) {
//         for (var i in mydata.data) {
//             var isVerified = mydata.data[6].is_verified;
// 	    if (isVerified){
	    	
// 	    }
	    
// 	    else{
	    	
		  
// 	    }
	    $("#authorized-text").text("This app is meant for authorized users");
		
        }
        
        
      });
    } 
	else {
    }
  }
	
	
	
  // This function is called when someone finishes with the Login
  // Button.  See the onlogin handler attached to it in the sample
  // code below.
  function checkLoginState() {
    FB.getLoginStatus(function(response) {
      statusChangeCallback(response);
    });
  }

  window.fbAsyncInit = function() {
  FB.init({
    appId      : '148790889053890',
    cookie     : true,  // enable cookies to allow the server to access 
                        // the session
    xfbml      : true,  // parse social plugins on this page
    version    : 'v2.8' // use graph api version 2.8
  });

  // Now that we've initialized the JavaScript SDK, we call 
  // FB.getLoginStatus().  This function gets the state of the
  // person visiting this page and can return one of three states to
  // the callback you provide.  They can be:
  //
  // 1. Logged into your app ('connected')
  // 2. Logged into Facebook, but not your app ('not_authorized')
  // 3. Not logged into Facebook and can't tell if they are logged into
  //    your app or not.
  //
  // These three cases are handled in the callback function.

  FB.getLoginStatus(function(response) {
    statusChangeCallback(response);
  });

  };

  // Load the SDK asynchronously
  (function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return;
    js = d.createElement(s); js.id = id;
    js.src = "https://connect.facebook.net/en_US/sdk.js";
    fjs.parentNode.insertBefore(js, fjs);
  }(document, 'script', 'facebook-jssdk'));

 
  
</script>	

	
	

 
 <div class="container">
 	
 	<table class="table">
 	
 	<thead>
 		<th> <h1>NewsTruth</h1> </th>
		<th class="text-right"> <h5 id="authorized-text"> </h5> </th>
 		<th class="text-right"> <div id="facebook-login" class="fb-login-button" data-width="50px" data-max-rows="1" data-size="small" data-button-type="login_with"
		data-show-faces="false" data-auto-logout-link="true" data-use-continue-as="false" onlogin="checkLoginState();"></div> </th>
 	</thead>

  	</table>
  	
 
</div>

<div class="container input-group ">
	
	<input type="text" class="form-control" placeholder="Input Topic To Search" >
	
	<span class="input-group-btn">
	<button class="btn btn-primary" id="input-button">Search Topic</button>
	</span>

</div>

<div class="container"> <p></p> </div> <!-- lol hacks -->

<div class="container jumbotron">
	
	<span class="border-0">
  <div id="address"></div>
  <div class="table-responsive">
    <table class="table table-hover table-striped">
      <thead>
        <tr>
          <th>Article</th>
          <th>Vote</th>
          <th>Timer</th>
        </tr>
      </thead>
      
      <tbody>
        
        <tr>
          <td><a id="headline1"></a></td>
          <td><a href="#" onclick="voteForCandidate()" class="btn btn-primary">Fake</a>
          <a href="#" onclick="voteForCandidate()" class="btn btn-primary">Not Fake</a>
          <a href="#" onclick="voteForCandidate()" class="btn btn-primary">Unsure</a></td>
          <td id="time-1"></td>
        </tr>
        
        <tr>
          <td><a id="headline2"></a></td>
          <td><a href="#" onclick="voteForCandidate()" class="btn btn-primary">Fake</a>
          <a href="#" onclick="voteForCandidate()" class="btn btn-primary">Not Fake</a>
          <a href="#" onclick="voteForCandidate()" class="btn btn-primary">Unsure</a></td>
          <td id="time-2"></td>
        </tr>
        
        <tr>
          <td><a id="headline3"></a></td>
          <td><a href="#" onclick="voteForCandidate()" class="btn btn-primary">Fake</a>
          <a href="#" onclick="voteForCandidate()" class="btn btn-primary">Not Fake</a>
          <a href="#" onclick="voteForCandidate()" class="btn btn-primary">Unsure</a></td>
          <td id="time-3"></td>
        </tr>

        <td><a id="headline4"></a></td>
          <td><a href="#" onclick="voteForCandidate()" class="btn btn-primary">Fake</a>
          <a href="#" onclick="voteForCandidate()" class="btn btn-primary">Not Fake</a>
          <a href="#" onclick="voteForCandidate()" class="btn btn-primary">Unsure</a></td>
          <td id="time-4"></td>
        </tr>
        
        <tr>
          <td><a id="headline5"></a></td>
          <td><a href="#" onclick="voteForCandidate()" class="btn btn-primary">Fake</a>
          <a href="#" onclick="voteForCandidate()" class="btn btn-primary">Not Fake</a>
          <a href="#" onclick="voteForCandidate()" class="btn btn-primary">Unsure</a></td>
          <td id="time-5"></td>
        </tr>
        
      </tbody>
    
    </table>

    <div id="msg"></div>
  </div>

</body>
</div>

</span>

<script src="https://cdn.rawgit.com/ethereum/web3.js/develop/dist/web3.js"></script>
</html>
